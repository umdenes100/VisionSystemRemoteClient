<!DOCTYPE html>
<html lang="en">
<head>

    <!--Metadata-->
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>ENES100Arduino</title>

    <!--Favicons-->
    <link rel="shortcut icon" href="../favicons/favicon.ico">
    <link rel="icon" sizes="16x16 32x32 64x64" href="../favicons/favicon.ico">
    <link rel="icon" type="image/png" sizes="196x196" href="../favicons/favicon-192.png">
    <link rel="icon" type="image/png" sizes="160x160" href="../favicons/favicon-160.png">
    <link rel="icon" type="image/png" sizes="96x96" href="../favicons/favicon-96.png">
    <link rel="icon" type="image/png" sizes="64x64" href="../favicons/favicon-64.png">
    <link rel="icon" type="image/png" sizes="32x32" href="../favicons/favicon-32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="../favicons/favicon-16.png">
    <link rel="apple-touch-icon" href="../favicons/favicon-57.png">
    <link rel="apple-touch-icon" sizes="114x114" href="../favicons/favicon-114.png">
    <link rel="apple-touch-icon" sizes="72x72" href="../favicons/favicon-72.png">
    <link rel="apple-touch-icon" sizes="144x144" href="../favicons/favicon-144.png">
    <link rel="apple-touch-icon" sizes="60x60" href="../favicons/favicon-60.png">
    <link rel="apple-touch-icon" sizes="120x120" href="../favicons/favicon-120.png">
    <link rel="apple-touch-icon" sizes="76x76" href="../favicons/favicon-76.png">
    <link rel="apple-touch-icon" sizes="152x152" href="../favicons/favicon-152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="../favicons/favicon-180.png">
    <meta name="msapplication-TileColor" content="#FFFFFF">
    <meta name="msapplication-TileImage" content="../favicons/favicon-144.png">
    <meta name="msapplication-config" content="../favicons/browserconfig.xml">

    <!--CSS-->
    <link rel="stylesheet" href="../misc/bootstrap/css/bootstrap.min.css">
    <link rel="stylesheet" href="../css/style.css">

    <!--JQuery, Bootstrap, and FontAwesome-->
    <script src="../misc/bootstrap/js/jquery-3.3.1.min.js"></script>
    <script src="../misc/bootstrap/js/tether.min.js"></script>
    <script src="../misc/bootstrap/js/bootstrap.min.js"></script>
    <script src="../misc/fontawesome/fontawesome-all.js"></script>

    <!--Our JS-->
    <script src="../js/ui.js"></script>
    <script src="../js/timer.js"></script>
    <script src="../js/communication.js"></script>

</head>
<body>

<nav class="navbar navbar-expand-md navbar-expand-lg">
    <div class="container">

        <!--Logo-->
        <a href="../index.html" id="logo" class="navbar-brand">ENES100<span id="prod">VisionSystemRemote</span></a>

        <!--Hamburger Button-->
        <button class="navbar-toggler float-right" type="button" data-toggle="collapse"
                data-target="#collapsibleNavbar">
            <span class="navbar-toggler-icon">☰</span>
        </button>

        <!--Collapsible Content-->
        <div id="collapsibleNavbar" class="navbar-collapse collapse">
            <ul class="navbar-nav ml-auto">
                <li class="nav-item">
                    <a class="nav-link" href="../library/index.html">Libraries</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="../static_pages/faqs.html">FAQs</a>
                </li>
            </ul>
        </div>

        <div class="nav-item float-right icons">
            <span id="status">&#9679;</span>
        </div>
    </div>
</nav>

<div class="content mt-5">
    <div class="row">
        <div class="col-md-6 offset-md-2 documentation">
            <h1 id="enes100arduinolibrary">Enes100ArduinoLibrary</h1>

            <p>Arduino library for use in the ENES100 course with Vision System v4 and APC220s</p>

            <h2 id="downloadingandinstallation">Downloading and Installation</h2>

            <p> To use this library, press the Download button on the right, or alternatively, download the contents
                from <a href="https://github.com/umdenes100/Enes100ArduinoLibrary">this Github repository</a> by going
                to the green <strong>Clone or Download</strong> menu and clicking <strong>Download ZIP</strong>. (There
                is no need to unzip the file.)
                <br>
                Open the Arduino IDE and install the library by going to <strong>Sketch > Include Library > Add .ZIP
                    Library</strong> and selecting the downloaded file. You must have Arduino IDE version 1.5.0 or
                above. The most current version of Arduino IDE can be downloaded from the <a
                        href="https://www.arduino.cc/en/Main/Software">Arduino website</a>.</p>

            <p><strong>If you have an older version of the library on your computer, you <em>must</em> delete it before
                adding a newer version.</strong> Failure to do this may cause file conflicts and it is not guaranteed
                that the library will work properly.</p>

            <h2 id="setup">Setup</h2>

            <h3 id="hardware">Hardware</h3>

            <p>Communication with the Vision System is done using APC220 wireless RF transceivers. APC220s are available
                in your team electrical toolbox or can be checked out from the tool cabinet through a Teaching Fellow.
                The APC220 has 7 pins:</p>

            <table class="table">
                <thead>
                    <tr>
                        <th>Pin</th>
                        <th>Description</th>
                        <th>Connect to...</th>
                    </tr>
                </thead>
                <tr>
                    <td>
                        GND
                    </td>
                    <td>
                        Ground
                    </td>
                    <td>
                        Common Ground
                    </td>
                </tr>

                <tr>
                    <td>
                        VCC
                    </td>
                    <td>
                        Voltage Supply
                    </td>
                    <td>
                        +5V
                    </td>
                </tr>

                <tr>
                    <td>
                        EN
                    </td>
                    <td>
                        Enable
                    </td>
                    <td>
                        +5V
                    </td>
                </tr>

                <tr>
                    <td>
                        RXD
                    </td>
                    <td>
                        Serial Receive
                    </td>
                    <td>
                        Arduino Serial Transmit
                    </td>
                </tr>

                <tr>
                    <td>
                        TXD
                    </td>
                    <td>
                        Serial Transmit
                    </td>
                    <td>
                        Arduino Serial Receive
                    </td>
                </tr>

                <tr>
                    <td>
                        AUX
                    </td>
                    <td>
                        Auxiliary
                    </td>
                    <td>
                        Not Connected
                    </td>
                </tr>

                <tr>
                    <td>
                        SET
                    </td>
                    <td>
                        Setting Mode
                    </td>
                    <td>
                        +5V
                    </td>
                </tr>
            </table>
            <br>

            <h3 id="software">Software</h3>

            <p>To use the library, you have to direct the compiler to include it in your code. Go to <strong>Sketch >
                Include Library > ENES100</strong>, or add it manually by typing</p>

            <pre><code>#include "Enes100.h"
</code></pre>

            <p>at the very top of your file.</p>

            <p>All the functionality is encapsulated in the <code>Enes100</code> class. To use it, you’ll first need to
                create an instance of the class. At the top of your code (outside of the <code>setup()</code> and <code>loop()</code>
                functions), add</p>

            <pre><code>Enes100 enes("BlackBoxTeam", BLACK_BOX, 3, 8, 9);
</code></pre>

            <p>In the code shown above, <code>enes</code> is an identifier. You may replace it with any other valid C
                identifier. The first parameter is the name of your team, which will appear on the Vision System with
                your serial port. <code>BLACK_BOX</code> refers to the mission type of your team. The full list of valid
                mission names is</p>

            <ul>
                <li>BLACK_BOX</li>

                <li>CHEMICAL</li>

                <li>DEBRIS</li>

                <li>FIRE</li>

                <li>WATER</li>
            </ul>

            <p>(As with all code samples in this document, these are case sensitive.) The third argument is the ID of
                the marker that your team will be using. The third and fourth arguments are your serial receive and
                serial transmit pins (recall that your RX pin connects to the APC’s TX pin and vice versa).</p>

            <p>When choosing the pins to use for communication, there are a few things to keep in mind. Firstly, you
                cannot use pins 0 and 1 for RF communication (or for anything else). The RX and TX labels on those pins
                refer to the Arduino’s serial transmit and receive with the computer. If you block those pins, you will
                not be able to upload code to your Arduino. Secondly, it is preferable not to use PWM pins for your
                communication; you’ll want to save those for things like controlling your motors.</p>

            <p>That’s it! You’re now ready to communicate!</p>

            <h2 id="usage">Usage</h2>

            <p>Example code for each type of mission is included with the library. To view examples, open Arduino IDE
                and go to <strong>File > Examples > ENES100</strong>. (You must restart the IDE after adding the library
                for the examples to show.)</p>

            <p>For your OSV to get information about its location and its destination, you will need to communicate with
                the Vision System using the library. To get the location of the destination, use the <code>retreieveDestination()</code>
                method.</p>

            <pre><code>enes.retrieveDestination();
</code></pre>

            <p>This method returns a <code>bool</code> indicating if the operation succeeded. If the operation
                succeeded, the coordinates of the destination will be stored in the <code>Enes100</code>'s <code>destination</code>
                member. You can access the coordinates using</p>

            <pre><code>enes.destination.x; // x Coordinate
enes.destination.y; // y Coordinate
</code></pre>

            <p>For the Black Box mission, the destination is unknown. Calling <code>retrieveDestination()</code> is not
                required and doing so will not update the destination coordinates.</p>

            <p>To request an update of your OSV’s location, call the <code>updateLocation()</code> method of your <code>Enes100</code>
                object. This method also returns a value indicating if it succeeded or not.</p>

            <pre><code>if (enes.updateLocation()) {
    enes.location.x; // x Coordinate
    enes.location.y; // y Coordinate
    enes.location.theta; // Theta
}
</code></pre>

            <p>The x and y coordinates are the distance in meters from the y axis and x axis to the center of your
                marker. Theta is measured in radians from -π to π, with zero being parallel to the x axis, increasing
                counter-clockwise.</p>

            <p>At points in your mission, you may want to send information to be displayed on the Vision System. Writing
                information to the Vision System is similar to writing information to the Serial console. The <code>print()</code>
                function will write a message to the console. The <code>println()</code> function will write a message
                to the console followed by a new line. These functions can accept strings, integers, and doubles as
                arguments.</p>

            <pre><code>enes.print(“Our x coordinate is: “);
enes.println(enes.location.x);
</code></pre>

            <p><strong>Note: Your messages to the Vision System may not include the <code>#</code> or <code>*</code>
                characters. They <em>will not</em> appear in the message pane and may prevent further
                communication.</strong></p>

            <p>Once your OSV reaches the destination, alert the Vision System that you've done so with the <code>navigated()</code>
                method.</p>

            <pre><code>enes.navigated();
</code></pre>

            <p>As your OSV completes its objectives, it will need to alert the Vision System. When your OSV completes a
                base objective that requires transmission, call the <code>baseObjective()</code> method with the value
                that you've calculated. When your OSV completes a bonus objective that requires transmission, call the
                <code>bonusObjective()</code> method with the value that you've calculated.</p>

            <pre><code>enes.baseObjective(2.34);
enes.bonusObjective(STEEL);
</code></pre>

            <p>For the Water mission, valid water types for the base objective are</p>

            <ul>
                <li>FRESH</li>

                <li>POLLUTED</li>

                <li>SALT</li>
            </ul>

            <p>For the Debris mission, valid material types are</p>

            <ul>
                <li>COPPER</li>

                <li>STEEL</li>
            </ul>

            <p>Once you've finished your mission, you'll need to alert the Vision System that you're done. Use the
                <code>endMission()</code> method to stop the timer on the Vision System.</p>

            <pre><code>enes.endMission();
</code></pre>

            <h3 id="thecoordinateobject">The Coordinate Object</h3>

            <p>The ENES100 library also includes a Coordinate class that holds an x, y, and theta. Students may use
                Coordinates in their code as desired. The <code>destination</code> and <code>location</code> members of
                <code>Enes100</code> are Coordinate objects. The x, y, and theta are accessed in the same way as in
                <code>destination</code> and <code>location</code>, i.e. <code>coordinate.x</code>,
                <code>coordinate.y</code>, and <code>coordinate.theta</code>. For convenience, we have included 3
                constructors for the Coordinate object.</p>

            <pre><code>Coordinate coordinate1(); // Represents the point (0, 0, 0)
Coordinate coordinate2(1.2, 0.7); // Represents the point (1.2, 0.7, 0)
Coordinate coordinate3(1.2, 0.7, 1.1); // Represents the point (1.2, 0.7, 1.1)
</code></pre>

            <p>For the Black Box mission, the base objective must be transmitted using a Coordinate object.</p>

            <pre><code>Coordinate blackBox(3.2, 1.6);
baseObjective(blackBox);
</code></pre>

            <h2 id="functionlist">Function List</h2>

            <p>The following are functions of the <code>Enes100</code> class.</p>

            <p><code>void baseObjective(value)</code> <br/>
                Sends value for a base objective.</p>

            <p><code>void bonusObjective(value)</code> <br/>
                Sends value for a bonus objective.</p>

            <p><code>void endMission()</code> <br/>
                Alerts the Vision System that you've finished your mission. Prevents further code execution on the
                Arduino.</p>

            <p><code>void navigated()</code> <br/>
                Alerts the Vision System that you've reached your destination. For chemical teams, splits the timer.</p>

            <p><code>void print(message)</code> <br/>
                Sends a message to be displayed on the Vision System. Accepts a String, integer, or double as an
                argument.</p>

            <p><code>void println(message)</code> <br/>
                Sends a message to be displayed on the Vision System followed by a new line character. Accepts a String,
                integer, or double as an argument.</p>

            <p><code>bool retrieveDestination()</code> <br/>
                Returns: True on success, false on failure.
                Retrieves the coordinates of the destination from the Vision System.</p>

            <p><code>unsigned long updateLocation()</code> <br/>
                Returns: Time elapsed to update the location, or 0 on failure.
                Updates the OSV's location information.</p>

            <h2 id="competitionprocedures">Competition Procedures</h2>

            <p>During the competition, messages sent using <code>print()</code> and <code>println()</code> will not be
                shown on the Vision System console. The console will only print out the values that you send using
                <code>baseObjective()</code> and <code>bonusObjective()</code>.</p>
        </div>

        <div class="col-md-1 offset-md-1">
            <form class="sticky" method="get" action="Enes100ArduinoLibrary-master.zip">
                <button type="submit" class="btn btn-primary">Download</button>
            </form>
        </div>

    </div>
</div>

</body>
</html>